{% extends 'base.html' %}
{% load static %}
{% block title %}
GearVault
{% endblock %}

{% block content %}
<div class="container-fluid" id="main-content-panel">
  <div class="row">
    <div class="col-md-2" id="sidebar-panel">
      {% include 'sidebar.html' %}
    </div>
    <div class="col-md-10 mt-4" id="painel-content">
      <div class="row">
        <div class="col-md-3 mb-3">
          <div class="card text-white h-100" style="background-color: #083D77;">
            <div class="card-body">
              <h5 class="card-title">Produtos Cadastrados</h5>
              <p class="card-text display-6">{{ total_produtos }}</p>
            </div>
          </div>
        </div>
        <div class="col-md-3 mb-3">
          <div class="card text-white h-100" style="background-color: #083D77;">
            <div class="card-body">
              <h5 class="card-title">Total em Estoque</h5>
              <p class="card-text display-6">{{ total_estoque }}</p>
            </div>
          </div>
        </div>
        <div class="col-md-3 mb-3">
          <div class="card text-white h-100" style="background-color: #083D77;">
            <div class="card-body">
              <h5 class="card-title">Valor Total do Estoque</h5>
              <p class="card-text display-6">R$ {{ valor_total_estoque|floatformat:2 }}</p>
            </div>
          </div>
        </div>
        <div class="col-md-3 mb-3">
          <div class="card text-white h-100" style="background-color: #083D77;">
            <div class="card-body">
              <h5 class="card-title">Fornecedores</h5>
              <p class="card-text display-6">{{ fornecedores|length }}</p>
            </div>
          </div>
        </div>
      </div>
      <div class="row mt-4">
        <div class="col-md-4 mb-4">
          <div class="card h-100" style="border: 1px solid #083D77;">
            <div class="card-header text-white" style="background-color: #083D77;">Produtos Recentes</div>
            <ul class="list-group list-group-flush">
              {% for produto in produtos|slice:':5' %}
              <li class="list-group-item">
                <strong>{{ produto.nome }}</strong><br>
                Código: {{ produto.codigo }}<br>
                Fornecedor: {% if produto.fornecedor %}{{ produto.fornecedor.nome }}{% else %}-{% endif %}
              </li>
              {% empty %}
              <li class="list-group-item">Nenhum produto cadastrado.</li>
              {% endfor %}
            </ul>
          </div>
        </div>
        <div class="col-md-4 mb-4">
          <div class="card h-100" style="border: 1px solid #083D77;">
            <div class="card-header text-white" style="background-color: #083D77;">Minhas Compras</div>
            <ul class="list-group list-group-flush">
              {% for compra in compras|slice:':5' %}
              <li class="list-group-item">
                <strong>ID:</strong> {{ compra.id }}<br>
                <strong>Data:</strong> {{ compra.data }}<br>
                <strong>Fornecedor:</strong> {{ compra.fornecedor.nome }}<br>
                <strong>Valor:</strong> R$ {{ compra.valor_total|floatformat:2 }}
              </li>
              {% empty %}
              <li class="list-group-item">Nenhuma compra cadastrada.</li>
              {% endfor %}
            </ul>
          </div>
        </div>
        <div class="col-md-4 mb-4">
          <div class="card h-100" style="border: 1px solid #083D77;">
            <div class="card-header text-white" style="background-color: #083D77;">Estoques e Locais</div>
            <ul class="list-group list-group-flush">
              {% for estoque in estoques|slice:':5' %}
              <li class="list-group-item">
                <strong>Produto:</strong> {{ estoque.lote.item_compra.produto.nome }}<br>
                <strong>Lote:</strong> {{ estoque.lote.id }}<br>
                <strong>Local:</strong> {{ estoque.local.nome }}<br>
                <strong>Quantidade:</strong> {{ estoque.quantidade }}
              </li>
              {% empty %}
              <li class="list-group-item">Nenhum estoque cadastrado.</li>
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>
      <div class="row mt-4">
        <div class="col-md-6 mb-4">
          <div class="card h-100" style="border: 1px solid #083D77;">
            <div class="card-header text-white" style="background-color: #083D77;">Movimentações Recentes</div>
            <div class="card-body">
              <div class="row">
                {% for mov in movimentacoes|slice:':4' %}
                <div class="col-md-12 mb-3">
                  <div class="card h-100 border-secondary">
                    <div class="card-body">
                      <strong>Produto:</strong> {{ mov.produto.nome }}<br>
                      <strong>Quantidade:</strong> {{ mov.quantidade }}<br>
                      <strong>Valor Unitário:</strong> R$ {{ mov.valor_unitario|floatformat:2 }}<br>
                      <strong>Estoque:</strong> {{ mov.compra.estoque.nome }}<br>
                      <strong>Local:</strong> {{ mov.local.nome }}<br>
                      <strong>Data da Compra:</strong> {{ mov.compra.data }}
                    </div>
                  </div>
                </div>
                {% empty %}
                <div class="col-12">Nenhuma movimentação recente.</div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6 mb-4">
          <div class="card h-100" style="border: 1px solid #083D77;">
            <div class="card-header text-white" style="background-color: #083D77;">Fornecedores</div>
            <div class="card-body">
              <div class="row">
                {% for fornecedor in fornecedores|slice:':4' %}
                <div class="col-md-12 mb-3">
                  <div class="card h-100 border-secondary" style="min-height: 160px;">
                    <div class="card-body d-flex flex-column justify-content-center">
                      <h6 class="card-title">{{ fornecedor.nome }}</h6>
                      <p class="card-text mb-0">
                        <strong>CNPJ:</strong> {{ fornecedor.cnpj }}<br>
                        <strong>Email:</strong> {{ fornecedor.email }}<br>
                        <strong>Telefone:</strong> {{ fornecedor.telefone }}<br>
                        <strong>Endereço:</strong> {{ fornecedor.endereco }}<br>
                        <span style="visibility:hidden;">preenchimento</span>
                      </p>
                    </div>
                  </div>
                </div>
                {% empty %}
                <div class="col-12">Nenhum fornecedor cadastrado.</div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<style>
  #painel-content {
    transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1), margin-left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  #sidebar-panel {
    transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1), display 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
</style>

<script src="{% static 'painel-content-resize.js' %}"></script>
{% endblock %}